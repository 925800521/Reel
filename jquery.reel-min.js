/*
 Copyright (c) 2009-2011 Petr Vostrel (http://petr.vostrel.cz/)
 Dual licensed under the MIT (MIT-LICENSE.txt)
 and GPL (GPL-LICENSE.txt) licenses.

 jQuery Reel
 http://jquery.vostrel.cz/reel
 Version: 1.1.3-devel
 Updated: 2011-12-17

 Requires jQuery 1.4.3 or higher
*/
jQuery.reel||function(g,zb,wa,q){function J(e){return g.reel.instances.length?g.reel.instances.first().data(e):null}function Ab(e){return g.reel.instances.push(e[0])&&e}function Bb(e){return(g.reel.instances=g.reel.instances.not(aa(e.attr(ba))))&&e}function xa(e){return Cb&&"data:image/gif;base64,R0lGODlh"+e}function ya(e){return"<"+e+"/>"}function z(e){return"."+e}function za(e){return"http://code.vostrel.cz/"+e}function Xa(e){return"url("+e+")"}function S(e,a,n){return ca(e,Ya(a,n))}function Db(e){function a(){g.fn[this]||
(g.fn[this]=function(){return this})}g.each(e,a)}function Aa(e,a){return F(e)*(a?-1:1)}function ka(e){return e.originalEvent.touches[0]}function da(e){return e===q||typeof e=="string"?e:e+"px"}function aa(e){return"#"+e}function Eb(e){var a=[];g.each(e,function(n,h){a.push(n.replace(/([A-Z])/g,"-$1").toLowerCase()+":"+da(h))});return"{"+a.join(";")+";}"}function Fb(){var e=g().jquery.split(".");if(e=+e[0]<=1&&(+e[1]<4||+e[1]==4&&+e[2]<3))try{console.error("FATAL: jQuery Reel plug-in requires at least jQuery 1.4.3")}catch(a){}return e}
if(!Fb()){g.reel={version:"1.1.3-devel",def:{area:q,brake:0.5,clickfree:false,cw:false,delay:-1,directional:false,draggable:true,footage:6,entry:q,frame:1,frames:36,graph:q,hint:"",horizontal:true,image:q,images:[],indicator:0,inversed:false,klass:"",laziness:6,loops:true,monitor:q,opening:0,orbital:0,path:"",preloader:4,rebound:0.5,revolution:q,row:1,rows:0,spacing:0,speed:0,step:q,steps:q,stitched:0,suffix:"-reel",tempo:36,timeout:2,throwable:true,vertical:false,wheelable:true,annotations:q,attr:{},
crop:true,preload:"fidelity",scrollable:true,steppable:true,velocity:0}};g.fn.reel=function(e){var a=g.extend({},g.reel.def,e);e=function(h){var t=[];h.filter(Ba).each(function(){var d=g(this),c=a.images.length&&a.images||a.image||a.attr.src||d.attr(Za),A=la(a.attr.width||d.css($a)),o=la(a.attr.height||d.css(ab));!c||c==bb||!A||!o||t.push(d)});h.filter(z(x)).each(function(){t.push(g(this).unreel())});return g(t)}(this);var n=[];a.tooltip&&(a.hint=a.tooltip);a.hotspot&&(a.area=a.hotspot);e.each(function(){var h=
g(this),t=h.data(),d=function(f,b){t[f]=b;h.trigger("store",[f,b]);return b},c=function(f){var b=t[f];h.trigger("recall",[f,b]);return b},A={setup:function(f){if(h.hasClass(x))return o.call(f);var b=h.attr(a.attr).attr(Za),i=d(ba,h.attr(ba)||h.attr(ba,x+"-"+ +new Date).attr(ba)),k=h.attr("style"),j=g.extend({},h.data()),l=a.images,p=a.stitched,m=a.loops,v={x:la(h.css($a)||a.attr.width),y:la(h.css(ab)||a.attr.height)},B=d(Ca,a.orbital&&a.footage||a.rows<=1&&l.length||a.frames),Da=p?1:cb(B/a.footage);
i=aa(i+a.suffix);var ma=h.attr("class")||"",P=g(T,{id:i.substr(1),"class":ma+C+Gb});P=h.wrap(P.addClass(a.klass)).attr({"class":x});n.push(Ab(P)[0]);P=P.parent().bind(A.instance);d(db,l.length&&l.length||a.image||b.replace(/^(.*)\.(jpg|jpeg|png|gif)$/,"$1"+a.suffix+".$2"));d(eb,[]);d(G,a.frame);d(Ea,0);d(fb,a.spacing);d(Q,v);d(r,0);d(Fa,a.steps||a.frames);d(na,a.revolution||p/2||v.x*2);d(Ga,Da);d(U,1/(B-(m&&!p?0:1)));d(Hb,1/ca(B,c(Fa)));d(Ha,p);d(gb,p-(m?0:v.x));d(Ia,i);d(H,d(Ja,a.speed)<0);d(V,a.velocity||
0);d(W,a.vertical);d(I,(a.row-1)/(a.rows-1));d(X,Aa(1,!a.cw&&!p));d(ea,false);d(hb,a.brake);d(Ka,!!a.orbital);d(K,a.tempo/(g.reel.lazy?a.laziness:1));d(fa,q);d(ib,{src:b,classes:ma,style:k||bb,data:j});a.steppable||P.unbind("click.steppable");a.annotations||P.unbind(".annotations");D(true,"",{width:v.x,height:v.y});D(true,","+C+z(x),{display:"block",position:"relative"});L.bind(A.pool);o.call(f);h.trigger("setup")},instance:{teardown:function(f){var b=h.data(ib);h.parent().unbind(A.instance).children(Ba).unbind(w);
c(jb).remove();h.unbind(w).attr({"class":b.classes,src:b.src,style:b.style}).removeClass(x);h.data(b.data).siblings().remove();h.unwrap();Bb(h);oa();L.unbind(A.pool);Y.unbind(La).unbind(Ma);o.call(f)},start:function(){var f=c(Q),b=c(Ca),i=ca(b,c(Fa));i=d(r,1/i*((a.step||a.frame)-1));d(G,R(i*b)+1);h.attr("id");b=h.parent();var k=!c(ea)||a.rows<=1||!a.orbital||a.scrollable;i=d(Na,g(a.area||b));if(g.reel.touchy){D(true,C+z(x),{WebkitUserSelect:"none",WebkitBackgroundSize:a.images.length?"auto":c(Ha)&&
c(Ha)+"px "+f.y+"px"||f.x*a.footage+"px "+f.y*c(Ga)*(a.rows||1)*(a.directional?2:1)+"px"});i.bind(Ib,function(j){h.trigger("down",[ka(j).clientX,ka(j).clientY,true])}).bind(Jb,function(j){h.trigger("pan",[ka(j).clientX,ka(j).clientY,true]);return!k}).bind(Kb,function(){h.trigger("up",[true]);return false}).bind(Lb,function(){h.trigger("up",[true]);return false})}else{D(true,"",{cursor:"url("+Mb+"), "+kb});i.bind(a.wheelable?Nb:"",function(j,l){h.trigger("wheel",[l]);return false}).bind(a.clickfree?
Ob:Pb,function(j){if(!j.button){h.trigger("down",[j.clientX,j.clientY]);return false}}).bind(a.clickfree?Qb:"",function(){h.trigger("up");return false}).disableTextSelect()}a.hint&&i.attr(Rb,a.hint);a.monitor&&b.append(M=g(T,{"class":lb}))||(M=g());D(true,C+z(lb),{position:ga,left:0,top:0});D(true,C+z(mb),{display:"none"});D(true,C+z(nb),{position:ga,left:0,top:f.y-a.preloader,height:a.preloader,overflow:ob,backgroundColor:pb});D(true,z(Oa),{cursor:Xa(Sb)+", "+kb});a.indicator&&b.append(qb("x"));
a.rows>1&&a.indicator&&b.append(qb("y"))},preload:function(f){var b=c(Q),i=h.parent(),k=c(db),j=a.images,l=g.reel.preload[a.preload]||g.reel.preload[g.reel.def.preload];l=!j.length?[k]:l(j,a,c);var p=[],m=h[0];m.frames=l.length;m.preloaded=0;h.trigger("stop");for(i.append(E=g(T,{"class":nb}));l.length;){var v=a.path+l.shift(),B=g(new Image).addClass(mb).attr({width:b.x,height:b.y}).bind("load"+w,function(){m.preloaded++;g(this).unbind(w);E.css({width:1/m.frames*m.preloaded*b.x});if(m.frames==m.preloaded){E.remove();
j.length||h.attr({src:Tb}).css({backgroundImage:Xa(a.path+k)});h.trigger("loaded");o.call(f)}});i.append(B);p.push(v);setTimeout(function(Da,ma){return function(){Da.attr({src:ma})}}(B,v),0)}d(eb,p);d(jb,g('<style type="text/css">'+rb.join("\n")+"</style>").insertBefore(g("head link, head style").first()))},opening:function(){var f=a.entry||a.speed,b=c(r),i=a.opening;d(r,b-f*a.opening);d(fa,i*J(K))},openingDone:function(){pa=setTimeout(function(){h.trigger("play")},a.delay*1E3||0)},play:function(f){var b=
d(Pa,true);d(Qa,!b);ha();o.call(f)},pause:function(f){d(Pa,false);u();o.call(f)},stop:function(f){var b=d(Qa,true);d(Pa,!b);o.call(f)},down:function(f,b,i,k){if(a.draggable){d(qa,c(G));d(V,0);ra=sa(b,i,c(r),c(na),c(I));u();oa();N=false;c(Na).addClass(Oa);if(!k){Y.bind(Ma,function(j){h.trigger("pan",[j.clientX,j.clientY]);o.call(j);return false});a.clickfree||Y.bind(La,function(j){h.trigger("up");o.call(j)})}}o.call(f)},up:function(f,b){if(!a.draggable)return o.call(f);d(qa,false);d(ea,false);var i=
d(V,!a.throwable?0:F(ia[0]+ia[1])/60);O=i?1:0;i?ha():u();oa();c(Na).removeClass(Oa);!b&&Y.unbind(La).unbind(Ma);o.call(f)},pan:function(f,b,i){if(a.draggable&&Ra){Ra=false;u();var k={x:b-ra.x,y:i-ra.y};if(F(k.x)>0||F(k.y)>0){N=true;ra={x:b,y:i};var j=c(na),l=c(sb),p=c(W),m=d(r,tb(p?i-l.y:b-l.x,c(Sa),j,c(Ta),c(Ua),c(X)));d(ea,c(ea)||c(G)!=c(qa));(k=ub(p?k.y:k.x||0))&&d(H,k<0);if(a.orbital&&c(Ka)){d(W,F(i-l.y)>F(b-l.x));l=sa(b,i,m,j,c(I))}if(a.rows>1){k=c(Q).y;p=c(vb);var v=-p*k;d(I,g.reel.math.envelope(i-
l.y,p,k,v,v+k,-1))}!(m%1)&&!a.loops&&sa(b,i,m,j,c(I));h.trigger("fractionChange")}}o.call(f)},wheel:function(f,b){var i=cb(Ub(F(b))/2);i=Aa(i,b>0);b=0.0833*c(na);sa(q,q,c(r),b,c(I));d(r,tb(i,c(Sa),b,c(Ta),c(Ua),c(X)));i&&d(H,i<0);d(V,0);u();o.call(f);h.trigger("fractionChange");return false},fractionChange:function(f,b){b=d(r,ta.fraction(b,a,c));var i=d(G,1+Z(b/c(U))),k=a.rows>1,j=a.orbital;d(Ka,!!j&&(i<=j||i>=a.footage-j+2));if(!a.loops&&a.rebound){!y&&!(b%1)?Va++:(Va=0);Va>=a.rebound*1E3/J(K)&&
d(H,!c(H))}h.trigger(k?"rowChange":"frameChange");o.call(f)},rowChange:function(f,b){var i=c(r)/c(U)+1;b=d(I,ta.row(b,a,c));b=S(0,a.rows-1,Z(b*a.rows));d(G,Z(i+b*a.frames));o.call(f);h.trigger("frameChange")},frameChange:function(f,b){var i=d(r,ta.fraction(!b?q:c(U)*(b-1),a,c));b=ta.frame(b,a,c);footage=a.footage;if(c(W)){b=a.inversed?footage+1-b:b;b+=footage}if(b==c(Ea))return f.stopImmediatePropagation();var k=a.horizontal,j=c(Ia),l=a.rows>1,p=a.images,m=c(Q);b=d(Ea,d(G,b));var v=(c(W)?m.y:m.x)-
a.indicator,B=S(0,v,R(g.reel.math.interpolate(c(r),-1,v+2)));B=!a.cw||a.stitched?B:v-B;g(z(ua+".x"),j).css(c(W)?{left:0,top:B}:{left:B,top:m.y-a.indicator});if(l){l=m.y-a.indicator;l=S(0,l,R(g.reel.math.interpolate(c(I),-1,l+2)));g(z(ua+".y"),j).css({top:l})}if(p.length)h.attr({src:a.path+p[b-1]});else{if(a.stitched)k=[-R(i*c(gb))+$,0+$];else{i=b%footage-1;i=i<0?footage-1:i;j=Z((b-0.1)/footage);j+=a.rows>1?0:c(H)?0:c(Ga);b=c(fb);j=j*((k?m.y:m.x)+b);m=i*((k?m.x:m.y)+b);k=p.length?[0,0]:k?[-m+$,-j+
$]:[-j+$,-m+$]}h.css({backgroundPosition:k.join(C)})}o.call(f)},stepLeft:function(){u();d(H,false);h.trigger("fractionChange",c(r)-c(U)*c(X))},stepRight:function(){u();d(H,true);h.trigger("fractionChange",c(r)+c(U)*c(X))},"click.steppable":function(f){if(N)return f.stopPropagation();h.trigger(f.clientX-h.offset().left>0.5*c(Q).x?"stepRight":"stepLeft")},"setup.annotations":function(){var f=c(Q),b=h.parent(),i={position:ga,width:f.x,height:f.y,left:0,top:0};D(true,C+z(Wa),i);a.crop&&D(true,C+z(Wa),
{clip:"rect(0 "+da(f.x)+" "+da(f.y)+" 0)"});b.append(s=g(T,{"class":Wa+C+wb+a.frame}))||(s=g());g.each(a.annotations,function(k,j){var l=g(T,j.node).attr({id:k}),p=j.image?g(ya(Ba),j.image):g(),m=j.link?g(ya(Vb),j.link):g();D(false,aa(k),{display:"none",position:ga});j.image||j.link&&l.append(m);j.link||j.image&&l.append(p);j.link&&j.image&&l.append(m.append(p));l.appendTo(s)})},"frameChange.annotations":function(f,b){b=b||c(G);f=s[0];f.className=f.className.replace(/frame-\d+/,wb+b);g.each(a.annotations,
function(i,k){i=g(aa(i),s);var j=k.start,l=k.end,p=b-(j||0),m=typeof k.x!=xb?k.x:k.x[p-1];k=typeof k.y!=xb?k.y:k.y[p-1];k={display:m!==q&&k!==q&&p>=0&&(!l||p<=l-j)?"block":"none",left:da(m)||0,top:da(k)||0};i.css(k)})},"setup.fu":function(){h.trigger("start")},"start.fu":function(){h.trigger("preload")},"loaded.fu":function(){h.trigger(a.rows>1&&!a.stitched?"rowChange":"frameChange").trigger("opening")}},pool:{"tick.reel":function(f){var b=c(V);if(O){var i=b-c(hb)/J(K)*O;b=!(b*i<=0||b<F(i))&&d(V,
b>F(c(Ja))?i:(O=y=0))}M.text(c(a.monitor));b&&O++;y&&y++;ub(0);Ra=true;if(y&&!b)return o.call(f);if(c(qa))return o.call(f,u());i=c(X)*Aa(1,c(H));b=(c(Qa)?b:F(c(Ja))+b)/J(K);var k=c(r);d(r,k-b*i);o.call(f)},"tick.reel.fu":function(f){h.trigger("fractionChange");c(fa)===q&&f.stopImmediatePropagation()},"tick.reel.opening":function(f){var b=(a.entry||a.speed)/J(K)*(a.cw?-1:1),i=c(r);d(r,i+b);b=d(fa,c(fa)-1);o.call(f);if(!(b>1)){L.unbind(ja+".opening",A.pool[ja+".opening"]);h.trigger("openingDone")}}}},
o=function(f){yb||delete this;return f},y,O=0,ha=function(){return y=0},u=function(){clearTimeout(pa);L.unbind(ja+".opening",A.pool[ja+".opening"]);h.trigger("play");return y=-a.timeout*J(K)},N=false,pa,M,s,E,qb=function(f){D(true,C+z(ua)+z(f),{position:ga,width:a.indicator,height:a.indicator,overflow:ob,backgroundColor:pb});return g(T,{"class":[ua,f].join(C)})},rb=[],D=function(f,b,i){var k=c(Ia);b=b.split(",");f&&g.each(b,function(j,l){b[j]=k+l});rb.push(b.join(",")+Eb(i));return i},Va=0,ra={x:0,
y:0},ub=function(f){return ia.push(f)&&ia.shift()&&f},oa=function(){return ia=[0,0]},ia=oa(),tb=a.graph||g.reel.math[a.loops?"hatch":"envelope"],ta=g.reel.normal,sa=function(f,b,i,k,j){d(Sa,i);d(vb,j);d(Ta,a.loops?0:-i*k);d(Ua,a.loops?k:k-i*k);return f&&d(sb,{x:f,y:b})||q},Ra=true,Y;try{Y=g.browser.opera?L:g.unique(L.add(zb.top.document))}catch(Wb){Y=L}A.setup()});va=va||function h(){var t=+new Date,d=J(K);if(d){L.trigger(ja);g.reel.cost=(+new Date+g.reel.cost-t)/2;return va=setTimeout(h,ca(4,1E3/
d-g.reel.cost))}else return va=q}();return g(n)};g.fn.unreel=function(){return this.trigger("teardown")};g.reel.math={envelope:function(e,a,n,h,t,d){return a+ca(h,Ya(t,-e*d))/n},hatch:function(e,a,n,h,t,d){e=(e<h?t:0)+e%t;e=a+-e*d/n;return e-Z(e)},interpolate:function(e,a,n){return a+e*(n-a)}};g.reel.preload={linear:function(e){return e},fidelity:function(e,a){function n(o,y,O){function ha(E){for(;!(E>=1&&E<=M);)E+=E<1?+M:-M;return A[O+E]||(A[O+E]=!!u.push(E))}if(!o.length)return[];var u=[],N=4*y,
pa=a.frame,M=o.length;y=M/N;for(var s=0;s<N;s++)ha(pa+R(s*y));for(;y>1;){s=0;N=u.length;for(y/=2;s<N;s++)ha(R(u[s]+y))}for(s=0;s<u.length;s++)u[s]=o[u[s]-1];return u}var h=a.orbital?2:a.rows||1,t=a.orbital?a.footage:a.frames,d=(a.row-1)*t,c=[].concat(e),A=new Array(e.length);e=h<2?[]:c.slice(d,d+t);return n(e,1,d).concat(n(c,h,0))}};g.reel.normal={fraction:function(e,a,n){e=e!=q?e:n(r);return a.loops?e-Z(e):S(0,1,e)},row:function(e,a,n){return S(0,1,e!=q?(e-1)/(a.rows-1):n(I))},frame:function(e,a,
n){e=e!=q?R(e):n(G);var h=a.orbital?2:a.rows||1;n=n(Ca)*h;e=a.loops?e%n||n:S(1,n,e);return e<0?e+n:e}};g.reel.touchy=/iphone|ipod|ipad|android/i.test(navigator.userAgent);g.reel.lazy=/iphone|ipod|android/i.test(navigator.userAgent);g.reel.instances=g();g.reel.cost=0;g.reel.leader=J;Db("mousewheel disableTextSelect enableTextSelect".split(/ /));var L=g(wa);wa=+g.browser.version.split(".").slice(0,2).join(".");var yb=g.browser.msie,Cb=!(yb&&wa<8),kb="ew-resize",va,x="reel",Gb=x+"-overlay",ua=x+"-indicator",
nb=x+"-preloader",mb=x+"-cached",lb=x+"-monitor",Wa=x+"-annotations",Oa=x+"-panning",wb="frame-",Tb=xa("CAAIAIAAAAAAAAAAACH5BAEAAAAALAAAAAAIAAgAAAIHhI+py+1dAAA7")||za("blank.gif"),Mb=xa("EAAQAJECAAAAAP///////wAAACH5BAEAAAIALAAAAAAQABAAQAI3lC8AeBDvgosQxQtne7yvLWGStVBelXBKqDJpNzLKq3xWBlU2nUs4C/O8cCvU0EfZGUwt19FYAAA7")||za("jquery.reel.cursor-drag.gif"),Sb=xa("EAAQAJECAAAAAP///////wAAACH5BAEAAAIALAAAAAAQABAAQAIslI95EB3MHECxNjBVdE/5b2zcRV1QBabqhwltq41St4hj5konmVioZ6OtEgUAOw==")||za("jquery.reel.cursor-drag-down.gif"),
R=Math.round,Z=Math.floor,cb=Math.ceil,Ya=Math.min,ca=Math.max,F=Math.abs,Ub=Math.sqrt,la=parseInt,Na="area",ib="backup",H="backwards",U="bit",hb="brake",Ka="center",qa="clicked",sb="clicked_location",Sa="clicked_on",vb="clicked_row",X="cwish",Q="dimensions",r="fraction",G="frame",Ea="_frame",Ca="frames",Ua="hi",ob="hidden",db="image",eb="images",fa="opening_ticks",Ta="lo",Pa="playing",ea="reeling",na="revolution",I="row",Ga="rows",fb="spacing",Ja="speed",Ia="stage",Fa="steps",Ha="stitched",gb="stitched_travel",
Qa="stopped",jb="style",K="tempo",V="velocity",W="vertical",Hb="wheel_step",w=".reel",Pb="mousedown"+w,Ob="mouseenter"+w,Qb="mouseleave"+w,Ma="mousemove"+w,La="mouseup"+w,Nb="mousewheel"+w,ja="tick"+w,Lb="touchcancel"+w,Kb="touchend"+w,Ib="touchstart"+w,Jb="touchmove"+w,bb="",C=" ",ga="absolute",Vb="a",T=ya("div"),ab="height",pb=aa("000"),ba="id",Ba="img",xb="object",$="px",Za="src",Rb="title",$a="width"}}(jQuery,window,document);
