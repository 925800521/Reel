/*
 Copyright (c) 2009-2011 Petr Vostrel (http://petr.vostrel.cz/)
 Dual licensed under the MIT (MIT-LICENSE.txt)
 and GPL (GPL-LICENSE.txt) licenses.

 jQuery Reel
 http://jquery.vostrel.cz/reel
 Version: 1.1.3-devel
 Updated: 2011-12-23

 Requires jQuery 1.4.3 or higher
*/
jQuery.reel||function(g,Ab,Aa,p){function L(e){return g.reel.instances.length?g.reel.instances.first().data(e):null}function Bb(e){return g.reel.instances.push(e[0])&&e}function Cb(e){return(g.reel.instances=g.reel.instances.not(aa(e.attr(ba))))&&e}function Db(e){return"data:image/gif;base64,R0lGODlh"+e}function Ba(e){return"<"+e+"/>"}function w(e){return"."+e}function la(e){return g.reel.cdn+e}function ma(e){return"url("+e+")"}function S(e,a,n){return ca(e,$a(a,n))}function Eb(e){function a(){g.fn[this]||
(g.fn[this]=function(){return this})}g.each(e,a)}function Ca(e,a){return E(e)*(a?-1:1)}function na(e){return e.originalEvent.touches[0]}function Da(e){return e===p||typeof e=="string"?e:e+"px"}function aa(e){return"#"+e}function Fb(e){var a=[];g.each(e,function(n,h){a.push(n.replace(/([A-Z])/g,"-$1").toLowerCase()+":"+Da(h))});return"{"+a.join(";")+";}"}function Gb(){var e=g().jquery.split(".");if(e=+e[0]<=1&&(+e[1]<4||+e[1]==4&&+e[2]<3))try{console.error("FATAL: jQuery Reel plug-in requires at least jQuery 1.4.3")}catch(a){}return e}
if(!Gb()){g.reel={version:"1.1.3-devel",def:{area:p,brake:0.23,clickfree:false,cw:false,delay:-1,directional:false,draggable:true,footage:6,entry:p,frame:1,frames:36,graph:p,hint:"",horizontal:true,image:p,images:[],indicator:0,inversed:false,klass:"",laziness:6,loops:true,monitor:p,opening:0,orbital:0,path:"",preloader:4,rebound:0.5,revolution:p,row:1,rows:0,spacing:0,speed:0,step:p,steps:p,stitched:0,suffix:"-reel",tempo:36,timeout:2,throwable:true,vertical:false,wheelable:true,annotations:p,attr:{},
cursor:p,preload:"fidelity",scrollable:true,steppable:true,velocity:0}};g.fn.reel=function(e){var a=g.extend({},g.reel.def,e);e=function(h){var s=[];h.filter(Ea).each(function(){var c=g(this),d=a.images.length&&a.images||a.image||a.attr.src||c.attr(ab),y=oa(a.attr.width||c.css(bb)),o=oa(a.attr.height||c.css(cb));!d||d==pa||!y||!o||s.push(c)});h.filter(w(u)).each(function(){s.push(g(this).unreel())});return g(s)}(this);var n=[];a.tooltip&&(a.hint=a.tooltip);a.hotspot&&(a.area=a.hotspot);e.each(function(){var h=
g(this),s=h.data(),c=function(i,b){s[i]=b;h.trigger("store",[i,b]);return b},d=function(i){var b=s[i];h.trigger("recall",[i,b]);return b},y={setup:function(i){if(h.hasClass(u))return o.call(i);var b=h.attr(a.attr).attr(ab),f=c(ba,h.attr(ba)||h.attr(ba,u+"-"+ +new Date).attr(ba)),j=h.attr("style"),l=g.extend({},h.data()),m=a.images,k=a.stitched,q=a.loops,A={x:oa(h.css(bb)||a.attr.width),y:oa(h.css(cb)||a.attr.height)},z=c(F,a.frame),da=c(Fa,a.orbital&&a.footage||a.rows<=1&&m.length||a.frames),Ga=k?
1:db(da/a.footage);f=aa(f+a.suffix);var eb=h.attr("class")||"";z=g(ea,{id:f.substr(1),"class":eb+G+Hb+G+fb+z});z=h.wrap(z.addClass(a.klass)).attr({"class":u});n.push(Bb(z)[0]);z=z.parent().bind(y.instance);c(gb,m.length&&m.length||a.image||b.replace(/^(.*)\.(jpg|jpeg|png|gif)$/,"$1"+a.suffix+".$2"));c(hb,[]);c(F,a.frame);c(Ha,0);c(ib,a.spacing);c(M,A);c(r,0);c(Ia,a.steps||a.frames);c(qa,a.revolution||k/2||A.x*2);c(Ja,Ga);c(T,1/(da-(q&&!k?0:1)));c(Ib,1/ca(da,d(Ia)));c(Ka,k);c(jb,k-(q?0:A.x));c(La,
f);c(J,c(fa,a.speed)<0);c(U,a.velocity||0);c(V,a.vertical);c(K,(a.row-1)/(a.rows-1));c(W,Ca(1,!a.cw&&!k));c(ga,false);c(kb,a.brake);c(Ma,!!a.orbital);c(N,a.tempo/(g.reel.lazy?a.laziness:1));c(X,0);c(Na,a.annotations)||z.unbind(".annotations");c(lb,{src:b,classes:eb,style:j||pa,data:l});a.steppable||z.unbind("click.steppable");B(true,pa,{width:A.x,height:A.y,overflow:Oa});B(true,","+G+w(u),{display:"block",position:"relative"});O.bind(y.pool);o.call(i);h.trigger("setup")},instance:{teardown:function(i){var b=
h.data(lb);h.parent().unbind(y.instance).children(Ea).unbind(v);d(mb).remove();h.unbind(v).attr({"class":b.classes,src:b.src,style:b.style}).removeClass(u);h.data(b.data).siblings().remove();h.unwrap();Cb(h);ra();O.unbind(y.pool);Y.unbind(Pa).unbind(Qa);o.call(i)},setup:function(){var i=d(M),b=d(Fa),f=ca(b,d(Ia));f=c(r,1/f*((a.step||a.frame)-1));c(F,Q(f*b)+1);h.attr("id");b=h.parent();var j=!d(ga)||a.rows<=1||!a.orbital||a.scrollable;f=c(Jb,g(a.area||b));if(g.reel.touchy){B(true,G+w(u),{WebkitUserSelect:"none",
WebkitBackgroundSize:a.images.length?"auto":d(Ka)&&d(Ka)+"px "+i.y+"px"||i.x*a.footage+"px "+i.y*d(Ja)*(a.rows||1)*(a.directional?2:1)+"px"});f.bind(Kb,function(k){h.trigger("down",[na(k).clientX,na(k).clientY,true])}).bind(Lb,function(k){h.trigger("pan",[na(k).clientX,na(k).clientY,true]);return!j}).bind(Mb,function(){h.trigger("up",[true]);return false}).bind(Nb,function(){h.trigger("up",[true]);return false})}else{var l=a.cursor=="hand"?ma(Ob)+","+Ra:a.cursor||ma(Pb)+","+Ra,m=a.cursor=="hand"?
ma(Qb)+","+Ra+" !important":false;B(true,pa,{cursor:l});B(true,w(Sa),{cursor:Rb});m&&B(false,w(sa)+", "+w(sa)+" *",{cursor:m});f.bind(a.wheelable?Sb:"",function(k,q){h.trigger("wheel",[q]);return false}).bind(a.clickfree?Tb:Ub,function(k){if(!(Vb?!k.button:!!k.button)){h.trigger("down",[k.clientX,k.clientY]);return false}}).bind(a.clickfree?Wb:"",function(){h.trigger("up");return false}).disableTextSelect()}a.hint&&f.attr(Xb,a.hint);a.monitor&&b.append(t=g(ea,{"class":nb}))||(t=g());B(true,G+w(nb),
{position:ta,left:0,top:0});B(true,G+w(ob),{display:"none"});B(true,G+w(pb),{position:ta,left:0,top:i.y-a.preloader,height:a.preloader,overflow:Oa,backgroundColor:qb});a.indicator&&b.append(rb("x"));a.rows>1&&a.indicator&&b.append(rb("y"))},preload:function(i){var b=d(M),f=h.parent(),j=d(gb),l=a.images,m=g.reel.preload[a.preload]||g.reel.preload[g.reel.def.preload];m=!l.length?[j]:m(l,a,d);var k=[],q=h[0];q.frames=m.length;q.preloaded=0;f.addClass(Sa).append(C=g(ea,{"class":pb}));for(h.trigger("stop");m.length;){var A=
a.path+m.shift(),z=g(new Image).addClass(ob).attr({width:b.x,height:b.y}).bind("load"+v,function(){q.preloaded++;g(this).unbind(v);C.css({width:1/q.frames*q.preloaded*b.x});if(q.frames==q.preloaded){C.remove();l.length||h.attr({src:Yb}).css({backgroundImage:ma(a.path+j)});f.removeClass(Sa);h.trigger("loaded");o.call(i)}});f.append(z);k.push(A);setTimeout(function(da,Ga){return function(){da.attr({src:Ga})}}(z,A),0)}c(hb,k);c(mb,g('<style type="text/css">'+sb.join("\n")+"</style>").prependTo("head"))},
opening:function(){if(!a.opening)return h.trigger("openingDone");var i=a.entry||a.speed,b=d(r),f=a.opening;c(r,b-i*a.opening);c(X,f*L(N))},openingDone:function(){R=setTimeout(function(){h.trigger("play")},a.delay*1E3||0)},play:function(i,b){b=c(fa,b||d(fa));b=c(Ta,!!b);c(Ua,!b);H();o.call(i)},pause:function(i){c(Ta,false);x();o.call(i)},stop:function(i){var b=c(Ua,true);c(Ta,!b);o.call(i)},down:function(i,b,f,j){if(a.draggable){c(ua,d(F));c(U,0);va=wa(b,f,d(r),d(qa),d(K));x();ra();ha=false;tb.addClass(sa);
if(!j){Y.bind(Qa,function(l){h.trigger("pan",[l.clientX,l.clientY]);o.call(l);return false});a.clickfree||Y.bind(Pa,function(l){h.trigger("up");o.call(l)})}}o.call(i)},up:function(i,b){if(!a.draggable)return o.call(i);c(ua,false);c(ga,false);var f=c(U,!a.throwable?0:E(ia[0]+ia[1])/60);P=f?1:0;f?H():x();ra();tb.removeClass(sa);!b&&Y.unbind(Pa).unbind(Qa);o.call(i)},pan:function(i,b,f){if(a.draggable&&Va){Va=false;x();var j={x:b-va.x,y:f-va.y};if(E(j.x)>0||E(j.y)>0){ha=true;va={x:b,y:f};var l=d(qa),
m=d(ub),k=d(V),q=c(r,vb(k?f-m.y:b-m.x,d(Wa),l,d(Xa),d(Ya),d(W)));c(ga,d(ga)||d(F)!=d(ua));(j=wb(k?j.y:j.x||0))&&c(J,j<0);if(a.orbital&&d(Ma)){c(V,E(f-m.y)>E(b-m.x));m=wa(b,f,q,l,d(K))}if(a.rows>1){j=d(M).y;k=d(xb);var A=-k*j;c(K,g.reel.math.envelope(f-m.y,k,j,A,A+j,-1))}!(q%1)&&!a.loops&&wa(b,f,q,l,d(K));h.trigger("fractionChange")}}o.call(i)},wheel:function(i,b){var f=db(Zb(E(b))/2);f=Ca(f,b>0);b=0.0833*d(qa);wa(p,p,d(r),b,d(K));c(r,vb(f,d(Wa),b,d(Xa),d(Ya),d(W)));f&&c(J,f<0);c(U,0);x();o.call(i);
h.trigger("fractionChange");return false},fractionChange:function(i,b){b=c(r,xa.fraction(b,a,d));var f=c(F,1+Z(b/d(T))),j=a.rows>1,l=a.orbital;c(Ma,!!l&&(f<=l||f>=a.footage-l+2));if(!a.loops&&a.rebound){!I&&!(b%1)?Za++:(Za=0);Za>=a.rebound*1E3/L(N)&&c(J,!d(J))}h.trigger(j?"rowChange":"frameChange");o.call(i)},rowChange:function(i,b){var f=d(r)/d(T)+1;b=c(K,xa.row(b,a,d));b=S(0,a.rows-1,Z(b*a.rows));c(F,Z(f+b*a.frames));o.call(i);h.trigger("frameChange")},frameChange:function(i,b){var f=c(r,xa.fraction(!b?
p:d(T)*(b-1),a,d));b=xa.frame(b,a,d);var j=a.footage;if(d(V)){b=a.inversed?j+1-b:b;b+=j}if(b==d(Ha))D(i);else{var l=a.horizontal,m=a.images,k=d(M);b=c(Ha,c(F,b));if(m.length)h.attr({src:a.path+m[b-1]});else{if(a.stitched)k=[-Q(f*d(jb))+$,0+$];else{f=b%j-1;f=f<0?j-1:f;j=Z((b-0.1)/j);j+=a.rows>1?0:d(J)?0:d(Ja);b=d(ib);j=j*((l?k.y:k.x)+b);k=f*((l?k.x:k.y)+b);k=m.length?[0,0]:l?[-k+$,-j+$]:[-j+$,-k+$]}h.css({backgroundPosition:k.join(G)})}}if(a.indicator){l=d(La);m=a.rows>1;k=d(M);f=(d(V)?k.y:k.x)-a.indicator;
b=S(0,f,Q(g.reel.math.interpolate(d(r),-1,f+2)));b=!a.cw||a.stitched?b:f-b;g(w(ya+".x"),l).css(d(V)?{left:0,top:b}:{left:b,top:k.y-a.indicator});if(m){k=k.y-a.indicator;k=S(0,k,Q(g.reel.math.interpolate(d(K),-1,k+2)));g(w(ya+".y"),l).css({top:k})}}o.call(i)},stepLeft:function(){x();c(J,false);h.trigger("fractionChange",d(r)-d(T)*d(W))},stepRight:function(){x();c(J,true);h.trigger("fractionChange",d(r)+d(T)*d(W))},"click.steppable":function(i){if(ha)return D(i);h.trigger(i.clientX-h.offset().left>
0.5*d(M).x?"stepRight":"stepLeft")},"setup.annotations":function(){d(M);var i=h.parent();g.each(d(Na),function(b,f){var j=g(ea,f.node).attr({id:b}).addClass($b),l=f.image?g(Ba(Ea),f.image):g(),m=f.link?g(Ba(ac),f.link):g();B(false,aa(b),{display:"none",position:ta});m.bind({"click.annotations":function(k){k.stopPropagation()}});f.image||f.link&&j.append(m);f.link||f.image&&j.append(l);f.link&&f.image&&j.append(m.append(l));j.appendTo(i)});h.trigger("frameChange.annotations")},"frameChange.annotations":function(i,
b){b=b||d(F);this.className=this.className.replace(/frame-\d+/,fb+b);g.each(d(Na),function(f,j){f=g(aa(f));var l=j.start,m=j.end,k=b-(l||1),q=typeof j.x!=yb?j.x:j.x[k];j=typeof j.y!=yb?j.y:j.y[k];j={display:q!==p&&j!==p&&k>=0&&(!m||k<=m-l)?"block":"none",left:Da(q)||0,top:Da(j)||0};f.css(j)})},"setup.fu":function(){h.trigger("preload")},"loaded.fu":function(){h.trigger(a.rows>1&&!a.stitched?"rowChange":"frameChange").trigger("opening")}},pool:{"tick.reel":function(i){var b=d(U);if(P){var f=b-d(kb)/
L(N)*P;b=!(b*f<=0||b<E(f))&&c(U,b>E(d(fa))?f:(P=I=0))}t.text(d(a.monitor));b&&P++;I&&I++;wb(0);Va=true;if(I&&!b)return D(i);if(d(ua))return D(i,x());if(!d(X)){f=d(W)*Ca(1,d(J));b=(d(Ua)?b:E(d(fa))+b)/L(N);var j=d(r);c(r,j-b*f);o.call(i)}},"tick.reel.opening":function(i){var b=(a.entry||a.speed)/L(N)*(a.cw?-1:1),f=d(r);c(r,f+b);b=c(X,d(X)-1);o.call(i);if(!b){h.trigger("openingDone");O.unbind(ja+".opening",y.pool[ja+".opening"])}},"tick.reel.fu":function(){h.trigger("fractionChange")}}},o=function(i){zb||
delete this;return i},D=function(i,b){return i.stopImmediatePropagation()||o.call(i)||b},I,P=0,H=function(){return I=0},x=function(){clearTimeout(R);O.unbind(ja+".opening",y.pool[ja+".opening"]);c(X,0);h.trigger("play");return I=-a.timeout*L(N)},ha=false,R,t,C,rb=function(i){B(true,G+w(ya)+w(i),{position:ta,width:a.indicator,height:a.indicator,overflow:Oa,backgroundColor:qb});return g(ea,{"class":[ya,i].join(G)})},sb=[],B=function(i,b,f){var j=d(La);b=b.split(",");i&&g.each(b,function(l,m){b[l]=j+
m});sb.push(b.join(",")+Fb(f));return f},Za=0,va={x:0,y:0},wb=function(i){return ia.push(i)&&ia.shift()&&i},ra=function(){return ia=[0,0]},ia=ra(),vb=a.graph||g.reel.math[a.loops?"hatch":"envelope"],xa=g.reel.normal,wa=function(i,b,f,j,l){c(Wa,f);c(xb,l);c(Xa,a.loops?0:-f*j);c(Ya,a.loops?j:j-f*j);return i&&c(ub,{x:i,y:b})||p},Va=true,Y;try{Y=g.browser.opera?O:g.unique(O.add(Ab.top.document))}catch(bc){Y=O}y.setup()});za=za||function h(){var s=+new Date,c=L(N);if(c){O.trigger(ja);g.reel.cost=(+new Date+
g.reel.cost-s)/2;return za=setTimeout(h,ca(4,1E3/c-g.reel.cost))}else return za=p}();return g(n)};g.fn.unreel=function(){return this.trigger("teardown")};g.reel.math={envelope:function(e,a,n,h,s,c){return a+ca(h,$a(s,-e*c))/n},hatch:function(e,a,n,h,s,c){e=(e<h?s:0)+e%s;e=a+-e*c/n;return e-Z(e)},interpolate:function(e,a,n){return a+e*(n-a)}};g.reel.preload={linear:function(e){return e},fidelity:function(e,a){function n(o,D,I){function P(C){for(;!(C>=1&&C<=R);)C+=C<1?+R:-R;return y[I+C]||(y[I+C]=!!H.push(C))}
if(!o.length)return[];var H=[],x=4*D,ha=a.frame,R=o.length;D=R/x;for(var t=0;t<x;t++)P(ha+Q(t*D));for(;D>1;){t=0;x=H.length;for(D/=2;t<x;t++)P(Q(H[t]+D))}for(t=0;t<H.length;t++)H[t]=o[H[t]-1];return H}var h=a.orbital?2:a.rows||1,s=a.orbital?a.footage:a.frames,c=(a.row-1)*s,d=[].concat(e),y=new Array(e.length);e=h<2?[]:d.slice(c,c+s);return n(e,1,c).concat(n(d,h,0))}};g.reel.normal={fraction:function(e,a,n){e=e!=p?e:n(r);return a.loops?e-Z(e):S(0,1,e)},row:function(e,a,n){return S(0,1,e!=p?(e-1)/(a.rows-
1):n(K))},frame:function(e,a,n){e=e!=p?Q(e):n(F);var h=a.orbital?2:a.rows||1;n=n(Fa)*h;e=a.loops?e%n||n:S(1,n,e);return e<0?e+n:e}};g.reel.touchy=/iphone|ipod|ipad|android/i.test(navigator.userAgent);g.reel.lazy=/iphone|ipod|android/i.test(navigator.userAgent);g.reel.cdn="http://code.vostrel.cz/";g.reel.instances=g();g.reel.cost=0;g.reel.leader=L;Eb("mousewheel disableTextSelect enableTextSelect".split(/ /));var O=g(Aa),tb=g("html");Aa=+g.browser.version.split(".").slice(0,2).join(".");var zb=g.browser.msie,
ka=navigator.userAgent;ka={linux:/linux/i.test(ka),windows:/windows/i.test(ka),mac:/macintosh/i.test(ka)};var Vb=zb&&Aa<=8,za,u="reel",Hb=u+"-overlay",ya=u+"-indicator",pb=u+"-preloader",ob=u+"-cached",nb=u+"-monitor",$b=u+"-annotation",sa=u+"-panning",Sa=u+"-loading",fb="frame-",Q=Math.round,Z=Math.floor,db=Math.ceil,$a=Math.min,ca=Math.max,E=Math.abs,Zb=Math.sqrt,oa=parseInt,Na="annotations",Jb="area",lb="backup",J="backwards",T="bit",kb="brake",Ma="center",ua="clicked",ub="clicked_location",Wa=
"clicked_on",xb="clicked_row",W="cwish",M="dimensions",r="fraction",F="frame",Ha="_frame",Fa="frames",Ya="hi",Oa="hidden",gb="image",hb="images",X="opening_ticks",Xa="lo",Ta="playing",ga="reeling",qa="revolution",K="row",Ja="rows",ib="spacing",fa="speed",La="stage",Ia="steps",Ka="stitched",jb="stitched_travel",Ua="stopped",mb="style",N="tempo",U="velocity",V="vertical",Ib="wheel_step",v=".reel",Ub="mousedown"+v,Tb="mouseenter"+v,Wb="mouseleave"+v,Qa="mousemove"+v,Pa="mouseup"+v,Sb="mousewheel"+v,
ja="tick"+v,Nb="touchcancel"+v,Mb="touchend"+v,Kb="touchstart"+v,Lb="touchmove"+v,pa="",G=" ",ta="absolute",ac="a",ea=Ba("div"),cb="height",qb=aa("000"),ba="id",Ea="img",Ra="move",yb="object",$="px",ab="src",Xb="title",bb="width",Yb=Db("CAAIAIAAAAAAAAAAACH5BAEAAAAALAAAAAAIAAgAAAIHhI+py+1dAAA7")||la("blank.gif"),Rb="wait",Pb=la("jquery.reel-"+(ka.mac?"black":"white")+".cur"),Ob=la("jquery.reel-drag.cur"),Qb=la("jquery.reel-drag-down.cur")}}(jQuery,window,document);
