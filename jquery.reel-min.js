(function(k,z){function u(s){return parseInt(s)}function A(s){k.each(s,function(){k.fn[this]||(k.fn[this]=function(){return this})})}var B={animate:true,delay:1,footage:6,frequency:0.25,frame:1,frames:36,horizontal:true,hotspot:undefined,hint:"",indicator:0,klass:"",loops:true,monitor:undefined,reversed:false,revolution:undefined,saves:false,sensitivity:20,spacing:0,step:undefined,steps:undefined,stitched:undefined,suffix:"-reel",tempo:25,timeout:1,tooltip:""},t=k(z),w=/iphone|ipod|ipad|android/i.test(navigator.userAgent),
v;A("mousewheel disableTextSelect".split(/ /));k.fn.reel=function(s){var C=function(q){var c=[];q.filter("img").each(function(){var n=k(this),e=n.attr("src"),f=u(n.css("width")),p=u(n.css("height"));!e||e==""||!f||!p||c.push(n)});q.filter("div.jquery-reel").each(function(){c.push(k(this))});return k(c)}(this),b=k.extend({},B,s),x=[],D=1E3/b.tempo;v=v||function(){return setInterval(function(){t.trigger("tick.reel")},D)}();C.each(function(){function q(){return n=-b.timeout*b.tempo}var c=k(this),n=b.animate?
Math.round(-b.delay*b.tempo):0,e=function(d,a){c.data(d,a);c.trigger("store");return a},f=function(d){d=c.data(d);c.trigger("recall");return d},p={setup:function(){if(!c.hasClass("jquery-reel")){var d=c.attr("src"),a=c.attr("id"),h=c.attr("class"),l=c.attr("style");d=d.replace(/^(.*)\.(jpg|jpeg|png|gif)$/,"$1"+b.suffix+".$2");var g={x:u(c.css("width")),y:u(c.css("height"))},i=k("<div>").attr("class",h).addClass("jquery-reel").addClass(b.klass),o=w||!b.saves?{display:"none"}:{opacity:0};x.push((c=
c.attr("id","").wrap(i).css(o).parent().attr("id",a).bind(p).css({display:"block",width:g.x+"px",height:g.y+"px",backgroundImage:"url("+d+")"}))[0]);e("frames",b.frames);e("spacing",b.spacing);e("offset",c.offset());e("dimensions",g);e("fraction",0);e("steps",b.steps||b.frames);e("resolution",Math.max(b.steps,b.frames));e("reversed",b.frequency<0);e("backup",{id:a,"class":h||"",style:l||""});v&&t.bind("tick.reel",p.tick);c.trigger("start")}},teardown:function(){c=c.unbind(p).find(".indicator, .monitor").remove().end().find("img").attr(c.data("backup")).unwrap().bind("setup",
function(){c.unbind("setup");p.setup()});v&&t.unbind("tick.reel",p.tick)},start:function(){c.css({position:"relative"});var d=b.hotspot?b.hotspot:c,a=f("dimensions"),h=f("frames"),l=Math.max(h,f("steps"));l=e("fraction",1/l*((b.step||b.frame)-1));e("frame",l*h+1);d.css({cursor:"url(data:image/gif;base64,R0lGODlhEAAQAJECAAAAAP///////wAAACH5BAEAAAIALAAAAAAQABAAQAI3lC8AeBDvgosQxQtne7yvLWGStVBelXBKqDJpNzLKq3xWBlU2nUs4C/O8cCvU0EfZGUwt19FYAAA7), w-resize"}).mouseenter(function(){c.trigger("enter")}).mouseleave(function(){c.trigger("leave")}).mousemove(function(g){c.trigger("over",
[g.pageX,g.pageY])}).mousewheel(function(g,i){c.trigger("wheel",[i]);return false}).dblclick(function(){c.trigger("animate")}).mousedown(function(g){c.trigger("down",[g.clientX,g.clientY])}).disableTextSelect().css({WebkitUserSelect:"none"}).each(function(){function g(m,r){k.each(r,function(E){m.addEventListener(E,this,false)})}function i(m){m.cancelable&&m.preventDefault();return false}function o(m){var r=m.touches[0];e("clicked",true);e("clicked_location",r.clientX);e("last_frame",e("clicked_on_frame",
f("frame")));return i(m)}function j(m){var r=m.touches[0];c.trigger("drag",[r.clientX,r.clientY]);return i(m)}function y(m){e("clicked",false);return i(m)}w&&g(this,{touchstart:o,touchmove:j,touchend:y,touchcancel:y,click:i,gesturestart:i,gesturechange:i,gestureend:i})});(b.hint||b.tooltip)&&d.attr("title",b.hint||b.tooltip);b.monitor&&c.append(k("<div/>",{className:"monitor",css:{position:"absolute",left:0,top:0}}));b.indicator&&c.append(k("<div/>").addClass("indicator").css({width:b.indicator+"px",
height:b.indicator+"px",top:a.y-b.indicator+"px",position:"absolute",backgroundColor:"#000"}));c.trigger("frameChange")},animate:function(){},tick:function(){k(".monitor",c).text(f(b.monitor));if(f("clicked"))return q();n&&n++;if(!n){var d=f("reversed"),a=b.frequency;a=d&&a>0||!d&&a<0?-a:a;d=a/b.tempo;e("fraction",f("fraction")+d);c.trigger("fractionChange")}},down:function(d,a){d=b.hotspot?b.hotspot:c;e("clicked",true);e("clicked_location",a);e("last_fraction",e("clicked_on",f("fraction")));t.mousemove(function(h){c.trigger("drag",
[h.clientX,h.clientY])}).mouseup(function(){c.trigger("up")});d.css({cursor:"url(data:image/gif;base64,R0lGODlhEAAQAJECAAAAAP///////wAAACH5BAEAAAIALAAAAAAQABAAQAIslI95EB3MHECxNjBVdE/5b2zcRV1QBabqhwltq41St4hj5konmVioZ6OtEgUAOw==), w-resize"});q()},up:function(){var d=b.hotspot?b.hotspot:c;e("clicked",false);t.unbind("mousemove mouseup");d.css({cursor:"url(data:image/gif;base64,R0lGODlhEAAQAJECAAAAAP///////wAAACH5BAEAAAIALAAAAAAQABAAQAI3lC8AeBDvgosQxQtne7yvLWGStVBelXBKqDJpNzLKq3xWBlU2nUs4C/O8cCvU0EfZGUwt19FYAAA7), w-resize"})},
drag:function(d,a){d=f("clicked_location");var h=f("clicked_on"),l=b.stitched,g=f("dimensions");Math.max(f("frames"),f("steps"));a=h+(b.reversed?-1:1)*(l?-1:1)/(b.revolution||l/2||g.x)*(a-d);e("fraction",a-Math.floor(a));c.trigger("fractionChange");q()},wheel:function(d,a){f("fraction");f("frames");f("steps");Math.ceil(Math.sqrt(Math.abs(a)));q();return false},fractionChange:function(d,a){f("steps");a=!a?f("fraction"):e("fraction",a);var h=f("last_fraction");d=a-h;a=a<0?0:a;a=a>1?1:a;h=a==1&&h==1||
a==0&&h==0;a=b.loops&&h?Math.abs(a-1):a;a=e("last_fraction",e("fraction",a));d&&e("reversed",d!=0?d<0:f("reversed"));d=f("frames");d=b.stitched?d:d-1;e("frame",a*d+1);c.trigger("frameChange")},frameChange:function(d,a){var h=f("frames");d=!a?f("fraction"):e("fraction",a/h);a=!a?f("frame"):e("frame",a);var l=f("dimensions"),g=f("steps"),i=f("spacing"),o=f("reversed");if(b.stitched){g=Math.round((a-1)*((b.loops?b.stitched:b.stitched-l.x)/g));j=0;o=-g+"px "+j+"px"}else{a=Math.round(a);g=Math.floor(a/
b.footage);j=a-g*b.footage-1;g=j==-1?g+j:g;j=j==-1?b.footage+j:j;a=b.horizontal?l.y:l.x;g=-g*(i+a);var j=-j*(i+(b.horizontal?l.x:l.y));h=Math.ceil(h/b.footage);i=h*a+(h-1)*i;g=o&&b.horizontal?g-i:g;j=o&&!b.horizontal?j-i:j;o=b.horizontal?j+"px "+g+"px":g+"px "+j+"px"}d=d*(l.x-b.indicator)+"px";c.css({backgroundPosition:o}).find(".indicator").css({left:d})}};c.ready(p.setup)});return k(x)}})(jQuery,this);
