/*
 Copyright (c) 2009-2010 Petr Vostrel (http://petr.vostrel.cz/)
 Dual licensed under the MIT (MIT-LICENSE.txt)
 and GPL (GPL-LICENSE.txt) licenses.

 http://jquery.vostrel.cz/reel
 Version: "Dancer" (will be 1.1 on release)
 Updated: 2010-06-22

 Requires jQuery 1.4.x
*/
(function(i,S,Ga,x){function Ha(l){return"<"+l+"/>"}function T(l){return"."+l}function U(l){return"url("+l+")"}function V(l,a){return+a.toFixed(l)}function ha(l,a,H){return I(l,ia(a,H))}function Ia(l,a){return l*a>0?a:-a}function Ja(l){function a(){i.fn[this]||(i.fn[this]=function(){return this})}i.each(l,a)}var Ka=i.reel={footage:6,frame:1,frames:36,hint:"",horizontal:true,hotspot:x,indicator:0,klass:"",loops:true,reversed:false,sensitivity:20,spacing:0,stitched:x,suffix:"-reel",tooltip:"",delay:-1,
friction:0.9,image:x,images:[],inertia:true,monitor:x,path:"",rebound:0.5,revolution:x,speed:0,step:x,steps:x,tempo:25,timeout:2};i.fn.reel=function(l){var a=i.extend({},Ka,l);l=function(e){var d=[];e.filter(La).each(function(){var f=i(this),u=a.images.length&&a.images||a.image||f.attr(ja),v=J(f.css(ka)),K=J(f.css(la));!u||u==ma||!v||!K||d.push(f)});e.filter(na+T(B)).each(function(){d.push(i(this))});return i(d)}(this);var H=[];W=W||function e(){C.trigger(X);return setTimeout(e,1E3/a.tempo)}();l.each(function(){var e=
i(this),d=function(c,b){e.data(c,b);e.trigger("store");return b},f=function(c){e.trigger("recall");return e.data(c)},u={setup:function(){if(!e.hasClass(B)){var c=e.attr(ja),b=e.attr(Ma);e.attr(Na);var g=e.attr("style"),k=a.images,h={x:J(e.css(ka)),y:J(e.css(la))},j={display:"block",width:h.x+r,height:h.y+r};j=e.attr({src:a.images?Oa:c}).bind(u).addClass(B).css(j);j=j.bind(oa,L).bind(pa,K);instances_count=H.push(j[0]);d(Y,k.length&&k.length||a.image||c.replace(/^(.*)\.(jpg|jpeg|png|gif)$/,"$1"+a.suffix+
".$2"));d(A,a.frame);d(D,k.length||a.frames);d(qa,a.spacing);d(M,h);d(q,0);d(N,a.steps||a.frames);d(E,"#"+b+a.suffix);d(O,a.speed<0);d(ra,{src:c,style:g||ma});W&&C.bind(X,u.tick);e.trigger("start")}},teardown:function(){i(f(E)).remove();e.removeClass(B).unbind(t).unbind(u).unbind(oa,L).unbind(pa,K).attr(e.data(ra)).enableTextSelect().removeData();Z();C.unbind($).unbind(P).unbind(X,u.tick)},start:function(){var c=f(M),b=f(D),g=I(b,f(N));g=d(q,1/g*((a.step||a.frame)-1));d(A,g*b+1);b=f(Y);g=a.images;
b=!g.length?[b]:[].concat(g);var k;e.attr("id");var h=e[0];h.frames=b.length;h.preloads=h.preloads||[];h.preloaded=h.preloaded||0;g=b.length!=h.preloads.length;var j=f(E).substr(1);j=i(F,{className:Pa,id:j,css:{position:"relative",width:c.x}}).insertAfter(e);var m=i(F,{className:Qa,css:{position:Q,left:0,top:-c.y,width:c.x,height:c.y}}).appendTo(j);m=d(aa,i(a.hotspot||m));Ra?m.css({WebkitUserSelect:"none"}).each(function(){function p(s,y){i.each(y,function(Sa){s.addEventListener(Sa,this,false)})}
function w(s){return s.cancelable&&s.preventDefault()||false}function o(s){var y=s.touches[0];e.trigger("down",[y.clientX,y.clientY,true]);return w(s)}function n(s){var y=s.touches[0];e.trigger("drag",[y.clientX,y.clientY,true]);return w(s)}function sa(s){e.trigger("up",[true]);return w(s)}p(this,{touchstart:o,touchmove:n,touchend:sa,touchcancel:sa})}):m.css({cursor:"url("+ta+"), "+ba}).bind(Ta,function(){e.trigger("enter")}).bind(Ua,function(){e.trigger("leave")}).bind(P,function(p){e.trigger("over",
[p.pageX,p.pageY])}).bind(Va,function(p,w){e.trigger("wheel",[w]);return false}).bind(Wa,function(){e.trigger("animate")}).bind(Xa,function(p){e.trigger("down",[p.clientX,p.clientY]);return false}).disableTextSelect();(a.hint||a.tooltip)&&m.attr(Ya,a.hint||a.tooltip);a.monitor&&j.append(i(F,{className:ua,css:{position:Q,left:0,top:-c.y}}));a.indicator&&j.append(i(F,{className:va,css:{width:a.indicator+r,height:a.indicator+r,top:-a.indicator+r,position:Q,backgroundColor:wa}}));g&&j.append(k=i(F,{className:Za,
css:{position:Q,left:0,top:-0.5*a.indicator,height:0.5*a.indicator,backgroundColor:wa}}));if(g)for(;b.length;){g=new Image;j=a.path+b.shift();i(g).load(function(){h.preloaded++;k.css({width:1/h.frames*h.preloaded*c.x});h.frames==h.preloaded&&k.remove()});g.src=j;h.preloads.push(g)}a.delay>0&&L();e.trigger("frameChange")},animate:function(){},tick:function(){var c=a.friction/a.tempo,b=f(G),g=b<0;b-=b*c;b=xa=b==xa?0:b;b=(g?ia:I)(0,V(3,b))||0;b=d(G,b);c=(f(R)?b:a.speed+b)/a.tempo;i(T(ua),f(E)).text(f(a.monitor));
ya(0);v&&v++;if(!(v&&!b)){if(f(ca))return L();d(q,f(q)+c);e.trigger("fractionChange")}},play:function(){var c=d(da,true);d(R,!c)},pause:function(){d(da,false)},stop:function(){var c=d(R,true);d(da,!c)},down:function(c,b,g,k){c=f(aa);d(ca,true);d(za,b);d(G,0);d(ea,d(Aa,f(q)));!k&&C.bind(P,function(h){e.trigger("drag",[h.clientX,h.clientY])}).bind($,function(){e.trigger("up")})&&c.css({cursor:U($a)+", "+ba})},up:function(c,b){c=f(aa);d(ca,false);var g=(z[0]+z[1]+z[2])/z.length/(b?15:20),k=(a.reversed?
-1:1)*(a.stitched?-1:1);d(G,a.inertia?g*k:0);Z();!b&&C.unbind($).unbind(P)&&c.css({cursor:U(ta)+", "+ba})},drag:function(c,b){var g=f(za);c=f(Aa);var k=a.stitched,h=f(M);h=a.revolution||k/2||h.x;var j=f(Ba);g=b-g;d(O,g>j);c=c+(a.reversed?-1:1)*(k?-1:1)/h*g;d(Ba,g);d(q,c);ya(b-Ca);Ca=b;e.trigger("fractionChange")},wheel:function(c,b){d(G,0);c=f(q);var g=1/I(f(D),f(N)),k=Da(ab(bb(b))/2);k=b<0?-k:k;d(O,k>0);d(q,c+k*g);e.trigger("fractionChange");return false},fractionChange:function(c,b){b=!b?f(q):d(q,
b);c=f(ea);c=b-c;if(c!==0){c=f(R)?0:(a.speed=Ia(c,a.speed));b=a.loops?b-Ea(b):ha(0,1,b);!(!a.loops&&a.rebound&&fa==a.rebound*1E3/a.tempo)||(a.speed=-c);b=d(ea,d(q,V(6,b)));d(A,b*(f(D)-1)+1);!v&&(fa=b==0||b==1?fa+1:0);e.trigger("frameChange")}},frameChange:function(c,b){var g=f(D);c=!b?f(q):d(q,V(6,(b-1)/(g-1)));b=!b?f(A):d(A,b);b=d(A,ga(b));var k=f(Y),h=a.images,j=f(M);f(N);var m=f(qa),p=f(O);if(a.stitched){m=a.loops?a.stitched:a.stitched-j.x;o=ga(c*m);n=0;p=[-o+r,n+r]}else{o=Ea(b/a.footage);n=b-
o*a.footage-1;o=n==-1?o+n:o;n=n==-1?a.footage+n:n;var w=a.horizontal?j.y:j.x,o=-o*(m+w),n=-n*(m+(a.horizontal?j.x:j.y));g=Da(g/a.footage);m=g*w+(g-1)*m;o=p&&a.horizontal?o-m:o;n=p&&!a.horizontal?n-m:n;p=h.length?[0,0]:a.horizontal?[n+r,o+r]:[o+r,n+r]}b=h[b-1]||k;m=j.x-a.indicator;c=ha(0,m,ga(c*(m+2))-1);j={background:U(a.path+b)+Fa+p.join(Fa)};a.images.length?e.attr({src:a.path+b}):e.css(j);i(T(va),f(E)).css({left:c+r})}},v,K=function(){return v=0},L=function(){return v=-a.timeout*a.tempo},fa=0,Ca=
0,xa=0,ya=function(c){z.push(c)&&z.shift()},Z=function(){return z=[0,0,0]},z=Z();u.setup()});return i(H)};Ja("mousewheel disableTextSelect enableTextSelect".split(/ /));var t=".reel",B="jquery-reel",Pa=B+"-overlay",va="indicator",Za="preloader",ua="monitor",Qa="interface",X="tick"+t,oa="down drag up wheel pause",pa="play",C=i(Ga),Ra=/iphone|ipod|ipad|android/i.test(navigator.userAgent),ba="w-resize",W,Oa="data:image/gif;base64,R0lGODlhCAAIAIAAAAAAAAAAACH5BAEAAAAALAAAAAAIAAgAAAIHhI+py+1dAAA7",ta="data:image/gif;base64,R0lGODlhEAAQAJECAAAAAP///////wAAACH5BAEAAAIALAAAAAAQABAAQAI3lC8AeBDvgosQxQtne7yvLWGStVBelXBKqDJpNzLKq3xWBlU2nUs4C/O8cCvU0EfZGUwt19FYAAA7",
$a="data:image/gif;base64,R0lGODlhEAAQAJECAAAAAP///////wAAACH5BAEAAAIALAAAAAAQABAAQAIslI95EB3MHECxNjBVdE/5b2zcRV1QBabqhwltq41St4hj5konmVioZ6OtEgUAOw==",ga=Math.round,Ea=Math.floor,Da=Math.ceil,ia=Math.min,I=Math.max,bb=Math.abs,ab=Math.sqrt,J=parseInt,ra="backup",ca="clicked",za="clicked_location",Aa="clicked_on",M="dimensions",Ba="distance_dragged",q="fraction",A="frame",D="frames",aa="hotspot",Y="image",ea="last_fraction",da="playing",O="reversed",qa="spacing",E="stage",N="steps",R="stopped",G=
"velocity",Wa="dblclick"+t,Xa="mousedown"+t,Ta="mouseenter"+t,Ua="mouseleave"+t,P="mousemove"+t,$="mouseup"+t,Va="mousewheel"+t,ma="",Fa=" ",Q="absolute",Na="class",na="div",F=Ha(na),la="height",wa="#000",Ma="id",La="img",r="px",ja="src",Ya="title",ka="width"})(jQuery,window,document);function log(i,S){console.log(i,S);return S};
