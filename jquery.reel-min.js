/*
 Copyright (c) 2009-2011 Petr Vostrel (http://petr.vostrel.cz/)
 Dual licensed under the MIT (MIT-LICENSE.txt)
 and GPL (GPL-LICENSE.txt) licenses.

 jQuery Reel
 http://jquery.vostrel.cz/reel
 Version: 1.1.1-devel
 Updated: 2011-04-09

 Requires jQuery 1.4.2 or higher
*/
jQuery.reel||function(j,ib,ha,p){function ia(k){return jb&&"data:image/gif;base64,R0lGODlh"+k}function kb(k){return"<"+k+"/>"}function ja(k){return"."+k}function ka(k){return"http://code.vostrel.cz/"+k}function la(k){return"url("+k+")"}function G(k){return+k.toFixed(4)}function U(k,a,u){return M(k,La(a,u))}function lb(k){function a(){j.fn[this]||(j.fn[this]=function(){return this})}j.each(k,a)}function ma(k,a){return v(k)*(a?-1:1)}function V(k){return k.originalEvent.touches[0]}j.reel={version:"1.1.1-devel",
def:{footage:6,frame:1,frames:36,hint:"",horizontal:true,hotspot:p,indicator:0,klass:"",loops:true,reversed:p,spacing:0,stitched:p,suffix:"-reel",tooltip:"",area:p,brake:0.5,clickfree:false,cw:false,delay:-1,directional:false,draggable:true,entry:p,graph:p,image:p,images:[],inversed:false,laziness:6,monitor:p,opening:0,orbital:0,path:"",preloader:4,rebound:0.5,revolution:p,row:1,rows:0,speed:0,step:p,steps:p,tempo:36,timeout:2,throwable:true,vertical:false,wheelable:true}};j.fn.reel=function(k){var a=
j.extend({},j.reel.def,k);k=function(g){var d=[];g.filter(mb).each(function(){var c=j(this),s=a.images.length&&a.images||a.image||c.attr(Ma),m=W(c.css(Na)),w=W(c.css(Oa));!s||s==Pa||!m||!w||d.push(c)});g.filter(Qa+ja(x)).each(function(){d.push(j(this))});return j(d)}(this);var u=[],t=a.tempo/(j.reel.lazy?a.laziness:1),D=1E3/t,H=D;a.reversed&&(a.cw=true);a.tooltip&&(a.hint=a.tooltip);a.hotspot&&(a.area=a.hotspot);X=X||function g(){Y={before:Y.now,now:new Date};try{H+=D-na(Y.now-Y.before)}catch(d){}B.trigger(E);
return X=setTimeout(g,M(3,H))}();k.each(function(){var g=j(this),d=function(f,b){g.data(f,b);g.trigger("store",[f,b]);return b},c=function(f){var b=g.data(f);g.trigger("recall",[f,b]);return b},s={setup:function(f){if(g.hasClass(x))return m.call(f);var b=g.attr(Ma),e=g.attr(nb),h=g.attr("style"),i=a.images,l=a.stitched,n=a.loops,r={x:W(g.css(Na)),y:W(g.css(Oa))},y=d(Ra,a.orbital&&a.footage||a.rows<=1&&i.length||a.frames),oa=l?1:na(y/a.footage),N={display:"block",width:r.x,height:r.y};e="#"+e+a.suffix;
var Sa=g.attr("className"),pa={position:"relative",width:r.x,height:r.y};pa=j(O,{id:e.substr(1),className:Sa+qa+ob,css:pa});N=g.wrap(pa).attr({className:x}).css(N).bind(s);u.push(N[0]);d(Ta,i.length&&i.length||a.image||b.replace(/^(.*)\.(jpg|jpeg|png|gif)$/,"$1"+a.suffix+".$2"));d(Ua,Sa);d(z,a.frame);d(Va,a.spacing);d(C,r);d(o,0);d(ra,a.steps||a.frames);d(Z,a.revolution||l/2||r.x*2);d(sa,oa);d($,1/(y-(n&&!l?0:1)));d(pb,1/M(y,c(ra)));d(ta,l);d(Wa,l-(n?0:r.x));d(aa,e);d(F,d(ua,a.speed)<0);d(I,0);d(J,
a.vertical);d(A,(a.row-1)/(a.rows-1));d(ba,ma(1,!a.cw&&!l));d(P,false);d(Xa,{src:b,style:h||Pa});X&&B.bind(E,s.tick);m.call(f);g.trigger("start")},teardown:function(f){g.unbind(q).unbind(s);var b=g.data("events"),e=g.clone().attr(g.data(Xa)).css({background:"transparent"}).removeClass(x).addClass(c(Ua));for(var h in b)j.each(b[h],function(i,l){e.bind(h+"."+l.namespace,l.handler,l.data)});j("img:"+va,g.parent()).remove();j(c(aa)).before(e).detach();ca();B.unbind(E,s.tick).unbind(E,s.opening_tick);
stage_pool.unbind(wa).unbind(xa);m.call(f)},start:function(){var f=c(C),b=c(Ra),e=M(b,c(ra));e=d(o,1/e*((a.step||a.frame)-1));d(z,e*b+1);g.attr("id");b=g.parent();e=j(O,{className:qb,css:{position:da,left:0,top:0,width:f.x,height:f.y,background:ya,opacity:0}}).appendTo(b);e=d(Ya,j(a.area||e));if(j.reel.touchy){g.css({WebkitUserSelect:"none",WebkitBackgroundSize:a.images.length?"auto":c(ta)&&c(ta)+"px "+f.y+"px"||f.x*a.footage+"px "+f.y*c(sa)*(a.rows||1)*(a.directional?2:1)+"px"});e.bind(rb,function(h){g.trigger("down",
[V(h).clientX,V(h).clientY,true])}).bind(sb,function(h){g.trigger("slide",[V(h).clientX,V(h).clientY,true]);return!(a.rows>1||a.orbital||c(P))}).bind(tb,function(){g.trigger("up",[true]);return false}).bind(ub,function(){g.trigger("up",[true]);return false})}else e.css({cursor:"url("+Za+"), "+za}).bind(vb,function(h,i){g.trigger("wheel",[i]);return false}).bind(wb,function(){g.trigger("play")}).bind(a.clickfree?xb:yb,function(h){g.trigger("down",[h.clientX,h.clientY]);return false}).bind(a.clickfree?
zb:"",function(){g.trigger("up");return false}).disableTextSelect();a.hint&&e.attr(Ab,a.hint);a.monitor&&b.append(Aa=j(O,{className:Bb,css:{position:da,left:0,top:0}}))||(Aa=j());a.indicator&&b.append($a("x"));a.rows>1&&a.indicator&&b.append($a("y"));g.trigger("preload")},preload:function(f){var b=c(C),e=g.parent(),h=c(Ta),i=a.images,l=!i.length?[h]:[].concat(i),n=g[0];n.frames=l.length;n.preloaded=0;g.trigger("stop");for(e.append(Ba=j(O,{className:Cb,css:{position:da,left:0,top:b.y-a.preloader,height:a.preloader,
overflow:va,backgroundColor:ya}}));l.length;){var r=a.path+l.shift(),y=j(new Image).hide().bind("load"+q,function(){n.preloaded++;j(this).unbind(q);Ba.css({width:1/n.frames*n.preloaded*b.x});if(n.frames==n.preloaded){Ba.remove();i.length||g.css({backgroundImage:la(a.path+h)});g.attr({src:Db}).trigger(a.rows>1&&!a.stitched?"rowChange":"frameChange").trigger("loaded").trigger("opening");m.call(f)}});e.append(y);setTimeout(function(oa,N){return function(){oa.attr({src:N})}}(y,r),0)}},tick:function(f){var b=
c(I);if(Q){var e=G(b-Eb*Q);b=!(b*e<=0||b<v(e))&&d(I,b>v(c(ua))?e:(Q=w=0))}Aa.text(c(a.monitor));b&&Q++;w&&w++;ab(0);Ca=true;if(w&&!b)return m.call(f);if(c(ea))return m.call(f,K());e=c(ba)*ma(1,c(F));var h=(c(Da)?b:v(c(ua))+b)/t;b=c(o);e=d(o,b-h*e);m.call(f);e!=b&&g.trigger("fractionChange")},opening:function(){var f=a.entry||a.speed,b=c(o),e=a.opening;d(o,b-f*a.opening);d(Ea,e*t);B.bind(E,s.opening_tick)},opening_tick:function(f){var b=(a.entry||a.speed)/t*(a.cw?-1:1),e=c(o);d(o,G(e+b));b=d(Ea,c(Ea)-
1);g.trigger("fractionChange");m.call(f);if(!(b>1)){B.unbind(E,s.opening_tick);Fb()}},play:function(f){var b=d(Fa,true);d(Da,!b);bb();m.call(f)},pause:function(f){d(Fa,false);K();m.call(f)},stop:function(f){var b=d(Da,true);d(Fa,!b);m.call(f)},down:function(f,b,e,h){if(a.draggable){d(ea,c(z));d(I,0);fa=ga(b,e,c(o),c(Z),c(A));K();ca();if(!h){stage_pool.css({cursor:la(Gb)+", "+za}).bind(xa,function(i){g.trigger("slide",[i.clientX,i.clientY]);m.call(i);return false});a.clickfree||stage_pool.bind(wa,
function(i){g.trigger("up");m.call(i)})}}m.call(f)},up:function(f,b){if(!a.draggable)return m.call(f);d(ea,false);d(P,false);var e=d(I,!a.throwable?0:v(R[0]+R[1])/60);Q=e?1:0;e?bb():K();ca();!b&&stage_pool.unbind(wa).unbind(xa)&&c(Ya).css({cursor:la(Za)+", "+za});m.call(f)},slide:function(f,b,e){if(a.draggable&&Ca){Ca=false;K();var h={x:b-fa.x,y:e-fa.y};if(v(h.x)>0||v(h.y)>0){fa={x:b,y:e};var i=c(Z),l=c(cb),n=c(J),r=d(o,db(n?e-l.y:b-l.x,c(Ga),i,c(Ha),c(Ia),c(ba)));d(P,c(P)||c(z)!=c(ea));(h=ab(n?h.y:
h.x||0))&&d(F,h<0);if(a.orbital&&c(eb)){d(J,v(e-l.y)>v(b-l.x));l=ga(b,e,r,i,c(A))}if(a.rows>1){h=c(C).y;n=c(fb);var y=-n*h;d(A,G(j.reel.math.envelope(e-l.y,n,h,y,y+h,-1)))}!(r%1)&&!a.loops&&ga(b,e,r,i,c(A));g.trigger("fractionChange")}}m.call(f)},wheel:function(f,b){if(!a.wheelable)return m.call(f);var e=na(Hb(v(b))/2);e=ma(e,b>0);b=0.2*c(Z);ga(p,p,c(o),b,c(A));d(o,db(e,c(Ga),b,c(Ha),c(Ia),c(ba)));e&&d(F,e<0);d(I,0);K();m.call(f);g.trigger("fractionChange");return false},fractionChange:function(f,
b){b=!b?c(o):d(o,b);b=a.loops?b-S(b):U(0,1,b);b=d(o,G(b));var e=c(z),h=d(z,1+S(b/c($))),i=a.orbital;d(eb,i&&(h<=i||h>=a.footage-i+2));if(!a.loops&&a.rebound){!w&&!(b%1)?Ja++:(Ja=0);Ja>=a.rebound*1E3/t&&d(F,!c(F))}i=c(C);var l=(c(J)?i.y:i.x)-a.indicator;b=U(0,l,T(j.reel.math.interpolate(b,-1,l+2)));b=!a.cw||a.stitched?b:l-b;j(ja(Ka+".x"),c(aa)).css(c(J)?{left:0,top:b}:{left:b,top:i.y-a.indicator});if(a.rows>1){b=c(C).y-a.indicator;b=U(0,b,T(j.reel.math.interpolate(c(A),-1,b+2)));j(ja(Ka+".y"),c(aa)).css({top:b})}if(h==
e&&h!=1)return m.call(f);g.trigger(a.rows>1?"rowChange":"frameChange");m.call(f)},rowChange:function(f,b){var e=S(c(o)/c($))+1;b=d(A,U(0,1,G(b!=p?(b-1)/(a.rows-1):c(A))));d(z,e+(a.rows<=1?0:T(b*(a.rows-1))*a.frames));m.call(f);g.trigger("frameChange")},frameChange:function(f,b){var e=!b?c(o):d(o,G(c($)*(b-1)));b=d(z,T(b?b:c(z)));var h=a.images,i=a.footage,l=c(C),n=a.horizontal;if(c(J)){b=a.inversed?i+1-b:b;b+=i}if(h.length)g.attr({src:a.path+h[b-1]});else{if(a.stitched)h=[-T(e*c(Wa))+L,0+L];else{e=
b%i-1;e=e<0?i-1:e;i=S((b-0.1)/i);i+=a.rows>1?0:c(F)?0:c(sa);b=c(Va);i=i*((n?l.y:l.x)+b);l=e*((n?l.x:l.y)+b);h=h.length?[0,0]:n?[-l+L,-i+L]:[-i+L,-l+L]}g.css({backgroundPosition:h.join(qa)})}m.call(f)}},m=function(f){gb||delete this;return f},w,Q=0,bb=function(){return w=0},K=function(){clearTimeout(hb);B.unbind(E,s.opening_tick);g.trigger("play");return w=-a.timeout*t},hb,Fb=function(){hb=setTimeout(function(){g.trigger("play")},a.delay*1E3||0)},Aa,Ba,$a=function(f){return j(O,{className:[Ka,f].join(qa),
css:{width:a.indicator,height:a.indicator,overflow:va,top:c(C).y-a.indicator,left:0,position:da,backgroundColor:ya}})},Ja=0,fa={x:0,y:0},ab=function(f){return R.push(f)&&R.shift()&&f},ca=function(){return R=[0,0]},R=ca(),Eb=a.brake/t,db=a.graph||j.reel.math[a.loops?"hatch":"envelope"],ga=function(f,b,e,h,i){d(Ga,e);d(fb,i);d(Ha,a.loops?0:-e*h);d(Ia,a.loops?h:h-e*h);return f&&d(cb,{x:f,y:b})||p},Ca=true;stage_pool=j.browser.opera?B:j.unique(B.add(ib.top.document));s.setup()});return j(u)};j.reel.math=
{envelope:function(k,a,u,t,D,H){return a+M(t,La(D,-k*H))/u},hatch:function(k,a,u,t,D,H){k=(k<t?D:0)+k%D;k=a+-k*H/u;return k-S(k)},interpolate:function(k,a,u){return a+k*(u-a)}};j.reel.touchy=/iphone|ipod|ipad|android/i.test(navigator.userAgent);j.reel.lazy=/iphone|ipod|android/i.test(navigator.userAgent);lb("mousewheel disableTextSelect enableTextSelect".split(/ /));var B=j(ha);ha=+j.browser.version.split(".").slice(0,2).join(".");var gb=j.browser.msie,jb=!(gb&&ha<8),za="ew-resize",X,Y={before:0,
now:new Date},x="jquery-reel",ob=x+"-overlay",Ka=x+"-indicator",Cb=x+"-preloader",Bb=x+"-monitor",qb=x+"-interface",Db=ia("CAAIAIAAAAAAAAAAACH5BAEAAAAALAAAAAAIAAgAAAIHhI+py+1dAAA7")||ka("blank.gif"),Za=ia("EAAQAJECAAAAAP///////wAAACH5BAEAAAIALAAAAAAQABAAQAI3lC8AeBDvgosQxQtne7yvLWGStVBelXBKqDJpNzLKq3xWBlU2nUs4C/O8cCvU0EfZGUwt19FYAAA7")||ka("jquery.reel.cursor-drag.gif"),Gb=ia("EAAQAJECAAAAAP///////wAAACH5BAEAAAIALAAAAAAQABAAQAIslI95EB3MHECxNjBVdE/5b2zcRV1QBabqhwltq41St4hj5konmVioZ6OtEgUAOw==")||ka("jquery.reel.cursor-drag-down.gif"),
T=Math.round,S=Math.floor,na=Math.ceil,La=Math.min,M=Math.max,v=Math.abs,Hb=Math.sqrt,W=parseInt,Ya="area",Xa="backup",F="backwards",$="bit",eb="center",Ua="classes",ea="clicked",cb="clicked_location",Ga="clicked_on",fb="clicked_row",ba="cwish",C="dimensions",o="fraction",z="frame",Ra="frames",Ia="hi",va="hidden",Ta="image",Ea="opening_ticks",Ha="lo",Fa="playing",P="reeling",Z="revolution",A="row",sa="rows",Va="spacing",ua="speed",aa="stage",ra="steps",ta="stitched",Wa="stitched_travel",Da="stopped",
I="velocity",J="vertical",pb="wheel_step",q=".reel",wb="dblclick"+q,yb="mousedown"+q,xb="mouseenter"+q,zb="mouseleave"+q,xa="mousemove"+q,wa="mouseup"+q,vb="mousewheel"+q,E="tick"+q,ub="touchcancel"+q,tb="touchend"+q,rb="touchstart"+q,sb="touchmove"+q,Pa="",qa=" ",da="absolute",Qa="div",O=kb(Qa),Oa="height",ya="#000",nb="id",mb="img",L="px",Ma="src",Ab="title",Na="width"}(jQuery,window,document);
